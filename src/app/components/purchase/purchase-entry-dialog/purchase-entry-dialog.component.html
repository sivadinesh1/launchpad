<ion-content>
    <div class="screen-header">
        <div>&nbsp;</div>

        <div style="align-items: center">
            <img
                class="cursor"
                src="/assets/images/svg/close.svg"
                (click)="close()"
                width="16px"
                height="16px"
            />
        </div>
    </div>

    <div class="action-row">
        <div>Purchase Order</div>
        <div>
            <span class="item" style="text-align: center; padding-right: 1rem">
                <mat-icon
                    #tooltip="matTooltip"
                    matTooltip="Edit"
                    matTooltipClass="tooltip"
                    (mousedown)="tooltip.hide()"
                    [ngStyle]="{ color: '#6d78d2', cursor: 'pointer' }"
                    (click)="goPurchaseEditScreen()"
                    >edit
                </mat-icon>
            </span>

            <span class="full-download" style="align-self: center">
                <button
                    style="border-radius: 0px"
                    appPreventDoubleClick
                    class="cursor"
                    type="button"
                    [throttleTime]="500"
                    mat-flat-button
                    type="button"
                    color="primary"
                    tabindex="-1"
                    (click)="exportToExcel()"
                >
                    Download
                </button>
            </span>

            <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
        </div>
    </div>

    <div class="customer-info">
        <div>
            <div style="padding: 5px">
                <div style="font-size: 13px; font-weight: 400; opacity: 0.6">
                    Invoice #
                </div>
                <div style="font-size: 14px; font-weight: 400">
                    {{ this.purchase_master_data?.invoice_no }}
                </div>
            </div>

            <div style="padding: 5px">
                <div style="font-size: 13px; font-weight: 400; opacity: 0.6">
                    Invoice Date
                </div>
                <div style="font-size: 14px; font-weight: 400">
                    {{
                        this.purchase_master_data?.invoice_date
                            | date: "dd-MMM-yyyy"
                    }}
                </div>
            </div>

            <div style="padding: 5px">
                <div style="font-size: 13px; font-weight: 400; opacity: 0.6">
                    Status
                </div>
                <div style="font-size: 14px; font-weight: 400">
                    {{
                        this.purchase_master_data?.status === "C"
                            ? "Completed"
                            : ""
                    }}
                </div>
            </div>
        </div>
        <div>
            <div style="padding: 5px">
                <div style="font-size: 13px; font-weight: 400; opacity: 0.6">
                    Vendor Name
                </div>
                <div style="padding: 5px 0px">
                    <div style="font-size: 14px; font-weight: 400">
                        {{ this.data?.vendor_name }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <table style="width: 100%">
            <thead>
                <tr class="header">
                    <th style="text-align: left">SNo</th>
                    <th style="text-align: left">CODE</th>
                    <th style="text-align: left">DESCRIPTION</th>
                    <th style="text-align: right">QTY</th>

                    <th style="text-align: right">MRP</th>

                    <th style="text-align: right">TAX</th>

                    <th style="text-align: right">NET AMT</th>
                </tr>
            </thead>
            <tbody>
                <tr
                    *ngFor="
                        let item of purchase_details_data
                            ? purchase_details_data
                            : [];
                        let idx = index
                    "
                    class="list-item row-color"
                >
                    <td style="text-align: left">{{ idx + 1 }}</td>
                    <td>{{ item.product_code }}</td>
                    <td>{{ item.product_description }}</td>

                    <td style="text-align: right">{{ item?.quantity }}</td>
                    <td style="text-align: right">
                        {{ (+item?.mrp).toFixed(2) }}
                    </td>

                    <td style="text-align: right">{{ item?.tax_rate }}</td>
                    <td style="text-align: right">
                        {{ (+item?.total_value).toFixed(2) }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 200px 100px">
        <div>&nbsp;</div>
        <div
            style="
                text-align: right;
                font-size: 15px;
                font-weight: 500;
                padding: 2px 6px;
            "
        >
            Sub Total
        </div>
        <div style="text-align: right; font-size: 15px; padding: 2px 6px">
            {{ (+purchase_master_data?.total_value).toFixed(2) }}
        </div>
        <div>&nbsp;</div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            Transport Chrgs
        </div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            {{ (+purchase_master_data?.transport_charges).toFixed(2) }}
        </div>
        <div>&nbsp;</div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            Unloading Chrgs
        </div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            {{ (+purchase_master_data?.unloading_charges).toFixed(2) }}
        </div>
        <div>&nbsp;</div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            Misc Chrgs
        </div>
        <div style="text-align: right; font-size: 14px; padding: 2px 6px">
            {{ (+purchase_master_data?.misc_charges).toFixed(2) }}
        </div>
        <div>&nbsp;</div>
        <div
            style="
                text-align: right;
                font-size: 15px;
                padding: 2px 6px;
                font-weight: 500;
            "
        >
            Net Total
        </div>
        <div style="text-align: right; font-size: 15px; padding: 2px 6px">
            {{ (+purchase_master_data?.net_total).toFixed(2) }}
        </div>
    </div>
</ion-content>
